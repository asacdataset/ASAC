换教室

【问题描述】
对于刚上大学的牛牛来说，他面临的第一个问题是如何根据实际情况申请合适的 课程。
在可以选择的课程中，有2n节课程安排在n个时间段上。在第i £ 1 < i < n ）个 时间段上，两节内容相同的课程同时在不同的地点进行，其中，牛牛预先被安排在教 室§上课，而另一节课程在教室di进行。
在不提交任何申请的情况下，学生们需要按时间段的顺序依次完成所有的n节安 排好的课程。如果学生想更换第i节课程的教室，则需要提出申请。若申请通过，学生 就可以在第i个时间段去教室di上课，否则仍然在教室％上课。
由于更换教室的需求太多，申请不一定能获得通过。通过计算，牛牛发现申请更 换第i节课程的教室时，申请被通过的概率是一个已知的实数ki，并且对于不同课程 的申请，被通过的概率是互相独立的。
学校规定，所有的申请只能在学期开始前一次性提交，并且每个人只能选择至多 m节课程进行申请。这意味着牛牛必须一次性决定是否申请更换每节课的教室，而不 能根据某些课程的申请结果来决定其他课程是否申请；牛牛可以申请自己最希望更换 教室的m门课程，也可以不用完这m个申请的机会，甚至可以一门课程都不申请。
因为不同的课程可能会被安排在不同的教室进行，所以牛牛需要利用课间时间从 一间教室赶到另一间教室。
牛牛所在的大学有v个教室，有e条道路。每条道路连接两间教室，并且是可 以双向通行的。由于道路的长度和拥堵程度不同，通过不同的道路耗费的体力可能会 有所不同。当第i £ 1 < i < n - 1 ）节课结束后，牛牛就会从这节课的教室出发，选择 一条耗费体力最少的蹈前往下一节课的教室。
现在牛牛想知道，申请哪几门课程可以使他因在教室间移动耗费的体力值的总和 的期望值最小，请你帮他求出这个最小值。
【输入格式】
第一行四个整数n,m,v,e。n表示这个学期内的时间段的数量；m表示牛牛最多 可以申请更换多少节课程的教室；v表示牛牛学校里教室的数量；e表示牛牛的学校 里道路的数量。
第二行n个正整数，第i £ 1 < i <n）个正整数表示d，即第i个时间段牛牛被安 排上课的教室；保证1 < Ci < v "
第三行n个正整数，第i £ 1<i<n）个正整数表示由,即第i个时间段另一间上 同样课程的教室；保证1 < di < v -
第四行n个实数，第i £ 1 < i < n ）个实数表示ki ,即牛牛申请在第i个时间段更 换教室获得通过的概率。保证0 < ki < 1 -
接下来e行，每行三个正整数aj , bj, Wj ,表示有一条双向道路连接教室aj , bj,通过这条道路需要耗费的体力值是Wj ；保证1 < aj, bj < v , 1 < Wj < 100。
保证 1 < n < 2000 , 0 < m < 2000 , 1 < v < 300 , 0 < e < 90000 -
保证通过学校里的道路，从任何一间教室出发，都能到达其他所有的教室。 保证输入的实数最多包含3位小数。
【输出格式】
输出一行，包含一个实数，四舍五入精确到小数点后恰好2位,表示答案。你的 输出必须和标准输出完全一样才算正确。
测试数据保证四舍五入后的答案和准确答案的差的绝对值不大于4 x 10-3。（如果 你不知道什么是浮点误差，这段话可以理解为：对于大多数的算法，你可以正常地使 用浮点数类型而不用对它进行特殊的处理）
